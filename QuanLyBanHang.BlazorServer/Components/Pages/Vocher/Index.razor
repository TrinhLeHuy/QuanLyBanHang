@page "/vouchers"
@inject IVoucherService VoucherService

<h3>üéüÔ∏è Qu·∫£n l√Ω Voucher</h3>

<div class="row mb-3">
    <div class="col-3">
        <input class="form-control" placeholder="T√¨m m√£ / m√¥ t·∫£"
               @bind="search" />
    </div>
    <div class="col-3">
        <select class="form-select" @bind="active">
            <option value="">-- T·∫•t c·∫£ --</option>
            <option value="true">Ho·∫°t ƒë·ªông</option>
            <option value="false">Ng·ª´ng</option>
        </select>
    </div>
    <div class="col">
        <button class="btn btn-primary" @onclick="Load">L·ªçc</button>
        <a class="btn btn-success ms-2" href="/vouchers/create">‚ûï Th√™m</a>
    </div>
</div>

<table class="table table-bordered">
    <thead>
        <tr>
            <th>M√£</th>
            <th>M√¥ t·∫£</th>
            <th>% Gi·∫£m</th>
            <th>Th·ªùi gian</th>
            <th>S·ªë l∆∞·ª£ng</th>
            <th>ƒê√£ d√πng</th>
            <th>Tr·∫°ng th√°i</th>
            <th></th>
        </tr>
    </thead>
    <tbody>
        @foreach (var v in vouchers)
        {
            <tr>
                <td>@v.Code</td>
                <td>@v.Description</td>
                <td>@v.DiscountPercent</td>
                <td>@v.StartDate:d - @v.EndDate:d</td>
                <td>@v.Quantity</td>
                <td>@v.UsedCount</td>
                <td>@(v.IsActive ? "Ho·∫°t ƒë·ªông" : "Ng·ª´ng")</td>
                <td>
                    <a class="btn btn-sm btn-warning" href="/vouchers/edit/@v.Id">S·ª≠a</a>
                    <a class="btn btn-sm btn-danger" href="/vouchers/delete/@v.Id">X√≥a</a>
                </td>
            </tr>
        }
    </tbody>
</table>

@code {
    List<Voucher> vouchers = new();
    string? search;
    bool? active;

    protected override async Task OnInitializedAsync()
    {
        await Load();
    }

    async Task Load()
    {
        vouchers = await VoucherService.GetAllAsync(search, active);
    }
}
